{% extends "layout.html" %}
{% block body %}
<script>
  function getWeatherDescription(code) {
    const weatherMap = {
        0: { description: "Clear Sky", icon: "â˜€ï¸" },
        1: { description: "Mainly Clear", icon: "ðŸŒ¤ï¸" },
        2: { description: "Partly Cloudy", icon: "â›…" },
        3: { description: "Overcast", icon: "â˜ï¸" },
        45: { description: "Foggy", icon: "ðŸŒ«ï¸" },
        48: { description: "Depositing Rime Fog", icon: "ðŸŒ" },
        51: { description: "Light Drizzle", icon: "ðŸŒ¦ï¸" },
        53: { description: "Moderate Drizzle", icon: "ðŸŒ§ï¸" },
        55: { description: "Heavy Drizzle", icon: "ðŸŒ§ï¸" },
        61: { description: "Light Rain", icon: "ðŸŒ§ï¸" },
        63: { description: "Moderate Rain", icon: "ðŸŒ§ï¸" },
        65: { description: "Heavy Rain", icon: "ðŸŒ§ï¸" },
        71: { description: "Light Snowfall", icon: "â„ï¸" },
        73: { description: "Moderate Snowfall", icon: "â„ï¸" },
        75: { description: "Heavy Snowfall", icon: "â„ï¸" },
        77: { description: "Snow Grains", icon: "ðŸŒ¨ï¸" },
        80: { description: "Light Showers", icon: "ðŸŒ¦ï¸" },
        81: { description: "Moderate Showers", icon: "ðŸŒ§ï¸" },
        82: { description: "Heavy Showers", icon: "ðŸŒ§ï¸" },
        85: { description: "Light Snow Showers", icon: "ðŸŒ¨ï¸" },
        86: { description: "Heavy Snow Showers", icon: "ðŸŒ¨ï¸" },
        95: { description: "Thunderstorm", icon: "â›ˆï¸" },
        96: { description: "Thunderstorm with Light Hail", icon: "â›ˆï¸" },
        99: { description: "Thunderstorm with Heavy Hail", icon: "â›ˆï¸" }
    };
    return weatherMap[code] || { description: "Unknown Weather", icon: "â“" };
}
  async function getWeather(latitude, longitude) {
  fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,weathercode,rain`)
  .then(response => response.json())
  .then(data => {
      console.log("Weather Data:", data);
      document.getElementById("current-temperature").textContent = data.current.temperature_2m + "Â°C" + getWeatherDescription(data.current.weathercode).icon;
  })
  .catch(error => console.error("Error:", error));
}

  function getUserLocation() {
    if ("geolocation" in navigator) {
      navigator.geolocation.getCurrentPosition(
        function (position) {
          document.getElementById("latitude").value = position.coords.latitude;
          document.getElementById("longitude").value = position.coords.longitude;
          getWeather(position.coords.latitude, position.coords.longitude);
        },
        function (error) {
          alert("Error getting location:", error);
        }
      );
    } else {
      console.error("Geolocation is not supported by this browser.");
    }
  }
  window.onload = getUserLocation();
const url = "https://api.open-meteo.com/v1/forecast";

</script>
<div class="px-30">
  <div class="min-h-96 rounded-xl flex items-center justify-center bg-linear-to-r from-cyan-500 to-blue-500">
    <h1 class="font-extrabold text-center text-7xl">ALERT</h1>

  </div>
</div>
<div class="px-30 mt-7 w-full text-xl">

    <h1 class="text-2xl font-bold text-center py-4">Alert Details</h1>
    <div class="max-w-4xl mx-auto">
        <h1 class="text-2xl font-bold text-center mb-4">SOS Alert</h1>

        <div class="bg-white shadow-md rounded-lg p-4 border-l-4 border-red-500">
            <div class="flex justify-between">
                <h2 class="text-lg font-semibold">Alert ID: {{ alert['id'] }}</h2>
            </div>

            <p class="text-gray-700"><strong>User:</strong> {{ alert['UserName'] }} ({{ alert['phone-number'] }})</p>
            <p class="text-gray-700" id="location"><strong>Location:</strong> {{ alert['latitude'] }}, {{ alert['longitude'] }}</p>
            <p class="text-gray-700"><strong>Distress Type:</strong> {{ alert['distress_type'] }}</p>
            <p class="text-gray-700"><strong>Message:</strong> {{ alert['message'] }}</p>

            <div class="mt-2">
                <span class="px-2 py-1 text-sm font-medium rounded-full bg-red-500 text-white">
                    {{ alert['status'] }}
                </span>
            </div>
        </div>
    </div>
</div>

{% endblock %}